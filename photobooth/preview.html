<script>
const params = new URLSearchParams(window.location.search);
const imgUrlEncoded = params.get('img');
if (imgUrlEncoded) {
  const imgUrl = decodeURIComponent(imgUrlEncoded); // decode full URL
  document.getElementById('photoPreview').src = imgUrl;
  document.getElementById('footerText').textContent = `Jakarta â€¢ ${new Date().toLocaleDateString('id-ID')}`;

  // QR code tetap ke halaman ini sendiri
  new QRCode(document.getElementById('qrcode'), {
    text: window.location.href,
    width: 300,
    height: 300,
    colorDark: '#000',
    colorLight: '#fff',
    correctLevel: QRCode.CorrectLevel.H
  });
  document.getElementById('qrUrl').textContent = window.location.href;

  // countdown 24 jam
  let remaining = 24*60*60;
  const countdownEl = document.getElementById('qrCountdown');
  const timer = setInterval(() => {
    const hours = Math.floor(remaining / 3600);
    const mins = Math.floor((remaining % 3600) / 60);
    const secs = remaining % 60;
    countdownEl.textContent = `Preview akan hilang dalam ${hours}h ${mins}m ${secs}s`;
    remaining--;
    if (remaining < 0) { clearInterval(timer); window.location.href='index.html'; }
  }, 1000);
}
</script>
