<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Preview Photobooth</title>
<link rel="stylesheet" href="receipt.css">
<script src="qrcode.min.js"></script>
</head>
<body>

<div class="panel">
  <div class="receiptCard" id="receiptCard">
    <div class="receiptHeader">
      <div class="headerTitle">VIZRIZE PHOTOBOOTH RECEIPT</div>
      <div class="headerSub">Jakarta • Photobooth</div>
    </div>
    <div class="photoHolder">
      <img id="photoPreview" class="photoImg" alt="Preview">
    </div>
    <div class="receiptFooter">
      <div id="footerText">Jakarta • --</div>
    </div>
  </div>

  <div class="qrRow">
    <div id="qrcode"></div>
    <div id="qrUrl" style="font-size:12px;color:#6b5c4b;word-break:break-all;"></div>
    <div id="qrCountdown" style="color:#6b5c4b;margin-top:6px;"></div>
  </div>
</div>

<script>
const RETURN_SECONDS = 24*60*60; // 24 jam
const params = new URLSearchParams(window.location.search);
const imgUrlEncoded = params.get('img');
if (imgUrlEncoded) {
  const imgUrl = decodeURIComponent(imgUrlEncoded); // decode URL
  document.getElementById('photoPreview').src = imgUrl;

  // footer & tanggal
  document.getElementById('footerText').textContent = `Jakarta • ${new Date().toLocaleDateString('id-ID')}`;

  // QR code tetap ke halaman ini sendiri
  new QRCode(document.getElementById('qrcode'), {
    text: window.location.href,
    width: 300,
    height: 300,
    colorDark: '#000',
    colorLight: '#fff',
    correctLevel: QRCode.CorrectLevel.H
  });

  document.getElementById('qrUrl').textContent = window.location.href;

  // countdown 24 jam
  let remaining = 24*60*60; // 24 jam
  const countdownEl = document.getElementById('qrCountdown');
  const timer = setInterval(() => {
    const hours = Math.floor(remaining / 3600);
    const mins = Math.floor((remaining % 3600) / 60);
    const secs = remaining % 60;
    countdownEl.textContent = `Preview akan hilang dalam ${hours}h ${mins}m ${secs}s`;
    remaining--;
    if (remaining < 0) { clearInterval(timer); window.location.href='index.html'; }
  }, 1000);
}

</script>
</body>
</html>
